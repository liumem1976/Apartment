## Developer Notes

Quick references for local development, migrations and CI.

1) Database and Alembic

- To recreate a fresh local database and run all migrations:

  ```powershell
  rm -Force data\app.db
  alembic upgrade head
  ```

- If your local DB already contains tables (e.g., created by tests or by SQLModel), avoid `table already exists` errors by stamping the DB to the merge revision before upgrade:

  ```powershell
  alembic stamp 0003_merge_heads
  alembic upgrade head
  ```

- When adding schema changes, create a new Alembic revision and keep migrations minimal:

  ```powershell
  alembic revision -m "add foo column" --autogenerate
  # review the generated file, adjust as needed
  alembic upgrade head
  ```

2) Formatting & lint

- CI validates formatting with `ruff`, `isort`, and `black`.
- To auto-fix locally (may need isolation to avoid Alembic import side-effects):

  ```powershell
  $env:ALEMBIC_HEADS_IGNORE = '1'
  python -m ruff check . --fix
  python -m isort .
  python -m black .
  Remove-Item Env:\ALEMBIC_HEADS_IGNORE
  ```

3) Running tests

- Run the full test suite locally:

  ```powershell
  python -m pytest -q
  ```

4) CI

- GitHub Actions workflow `CI` runs on PR and push; it runs lint checks, migrations (stamp+upgrade), then tests.

5) PR checklist (developer's quick reminders)

- Model changes require corresponding Alembic migrations.
- No runtime ALTERs in application code.
- Keep migrations small and reviewed.
- Ensure `pytest` and linters pass before merging.

---

Generated by automation on 2026-02-11 to help contributors follow repository conventions.
